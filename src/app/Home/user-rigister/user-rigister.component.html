<div class="register-page">
    <div class="background-image"></div>
    
    <div class="register-container py-3">
      <div class="register-wrapper">
        <!-- Header with Logo -->
        <div class="register-header">
          <div class="logo-container">
            <div class="logo-icon">
              <img src="assets/images/icon.png" alt="icon" style="width:auto; height: 40px; object-fit: cover; border-radius: 100%;">
            </div>
            <h1>SnipeTMS</h1>
          </div>
          <h2 class="mt-3">Create your account</h2>
        </div>
  
        <!-- Registration Form -->
        <form class="register-form" [formGroup]="signupForm" (ngSubmit)="onSubmit()">
          <div class="row">
            <!-- First Name -->
            <div class="col-md-6">
              <div class="form-group mb-3">
                <label for="firstName" class="form-label">First Name</label>
                <input type="text" class="form-control" id="firstName" formControlName="firstName" 
                       placeholder="Enter your first name" [class.is-invalid]="firstName?.invalid && (firstName?.dirty || firstName?.touched)">
                <div *ngIf="firstName?.invalid && (firstName?.dirty || firstName?.touched)" class="invalid-feedback">
                  <div *ngIf="firstName?.errors?.['required']">First name is required</div>
                </div>
              </div>
            </div>
            
            <!-- Last Name -->
            <div class="col-md-6">
              <div class="form-group mb-3">
                <label for="lastName" class="form-label">Last Name</label>
                <input type="text" class="form-control" id="lastName" formControlName="lastName" 
                       placeholder="Enter your last name" [class.is-invalid]="lastName?.invalid && (lastName?.dirty || lastName?.touched)">
                <div *ngIf="lastName?.invalid && (lastName?.dirty || lastName?.touched)" class="invalid-feedback">
                  <div *ngIf="lastName?.errors?.['required']">Last name is required</div>
                </div>
              </div>
            </div>
          </div>
  
          <!-- Email -->
          <div class="form-group mb-3">
            <label for="email" class="form-label">Email address</label>
            <input type="email" class="form-control" id="email" formControlName="email" 
                   placeholder="Enter your email" [class.is-invalid]="email?.invalid && (email?.dirty || email?.touched)">
            <div *ngIf="email?.invalid && (email?.dirty || email?.touched)" class="invalid-feedback">
              <div *ngIf="email?.errors?.['required']">Email is required</div>
              <div *ngIf="email?.errors?.['email']">Please enter a valid email</div>
            </div>
          </div>
  
          <!-- Password -->
          <div class="form-group mb-3">
            <label for="password" class="form-label">Password</label>
            <div class="password-input-group">
              <input [type]="showPassword ? 'text' : 'password'" class="form-control" id="password" 
                     formControlName="password" placeholder="Enter your password"
                     [class.is-invalid]="password?.invalid && (password?.dirty || password?.touched)"
                     autocomplete="new-password">
              <span class="password-toggle" (click)="togglePasswordVisibility()">
                <i class="bi" [ngClass]="{'bi-eye': showPassword, 'bi-eye-slash': !showPassword}"></i>
              </span>
            </div>
            <div *ngIf="password?.invalid && (password?.dirty || password?.touched)" class="invalid-feedback">
              <div *ngIf="password?.errors?.['required']">Password is required</div>
              <div *ngIf="password?.errors?.['minlength']">Password must be at least 6 characters</div>
            </div>
          </div>
  
          <!-- Confirm Password -->
          <div class="form-group mb-3">
            <label for="confirmPassword" class="form-label">Confirm Password</label>
            <div class="password-input-group">
              <input [type]="showConfirmPassword ? 'text' : 'password'" class="form-control" id="confirmPassword" 
                     formControlName="confirmPassword" placeholder="Confirm your password"
                     [class.is-invalid]="(confirmPassword?.invalid || signupForm.errors?.['passwordMismatch']) && (confirmPassword?.dirty || confirmPassword?.touched)"
                     autocomplete="new-password">
              <span class="password-toggle" (click)="toggleConfirmPasswordVisibility()">
                <i class="bi" [ngClass]="{'bi-eye': showConfirmPassword, 'bi-eye-slash': !showConfirmPassword}"></i>
              </span>
            </div>
            <div *ngIf="confirmPassword?.invalid && (confirmPassword?.dirty || confirmPassword?.touched)" class="invalid-feedback">
              <div *ngIf="confirmPassword?.errors?.['required']">Please confirm your password</div>
            </div>
            <div *ngIf="signupForm.errors?.['passwordMismatch'] && (confirmPassword?.dirty || confirmPassword?.touched)" class="invalid-feedback">
              Passwords do not match
            </div>
          </div>
  
          <!-- Phone Number -->
          <div class="form-group mb-3">
            <label for="phoneNumber" class="form-label">Phone Number</label>
            <input type="tel" class="form-control" id="phoneNumber" formControlName="phoneNumber" 
                   placeholder="Enter your phone number" [class.is-invalid]="phoneNumber?.invalid && (phoneNumber?.dirty || phoneNumber?.touched)">
            <div *ngIf="phoneNumber?.invalid && (phoneNumber?.dirty || phoneNumber?.touched)" class="invalid-feedback">
              <div *ngIf="phoneNumber?.errors?.['required']">Phone number is required</div>
              <div *ngIf="phoneNumber?.errors?.['pattern']">Please enter a valid phone number</div>
            </div>
          </div>
  
          <!-- Address -->
          <div class="form-group mb-3">
            <label for="address" class="form-label">Address</label>
            <textarea class="form-control" id="address" formControlName="address" 
                      placeholder="Enter your address" rows="2" [class.is-invalid]="address?.invalid && (address?.dirty || address?.touched)"></textarea>
            <div *ngIf="address?.invalid && (address?.dirty || address?.touched)" class="invalid-feedback">
              <div *ngIf="address?.errors?.['required']">Address is required</div>
            </div>
          </div>
  
          <!-- Gender -->
          <div class="form-group mb-3">
            <label class="form-label">Gender</label>
            <div class="d-flex gap-3">
              <div class="form-check">
                <input class="form-check-input" type="radio" id="male" value="MALE" formControlName="gender">
                <label class="form-check-label" for="male">Male</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" id="female" value="FEMALE" formControlName="gender">
                <label class="form-check-label" for="female">Female</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" id="other" value="OTHER" formControlName="gender">
                <label class="form-check-label" for="other">Other</label>
              </div>
            </div>
          </div>
  
          <!-- Date of Birth -->
          <div class="form-group mb-4">
            <label for="dateOfBirth" class="form-label">Date of Birth</label>
            <input type="date" class="form-control" id="dateOfBirth" formControlName="dateOfBirth" 
                   [class.is-invalid]="dateOfBirth?.invalid && (dateOfBirth?.dirty || dateOfBirth?.touched)">
            <div *ngIf="dateOfBirth?.invalid && (dateOfBirth?.dirty || dateOfBirth?.touched)" class="invalid-feedback">
              <div *ngIf="dateOfBirth?.errors?.['required']">Date of birth is required</div>
              <div *ngIf="dateOfBirth?.errors?.['underage']">You must be at least 18 years old</div>
            </div>
          </div>
  
          <!-- Organization ID (hidden if not needed in UI) -->
          <input type="hidden" formControlName="orgID">
  
          <button type="submit" class="btn btn-primary w-100 mb-3" [disabled]="!signupForm.valid || isLoading">
            <span *ngIf="!isLoading">Create Account</span>
            <span *ngIf="isLoading" class="d-flex align-items-center justify-content-center">
              <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
              Creating account...
            </span>
          </button>
  
          <div class="divider my-4">
            <span class="divider-text">OR</span>
          </div>
  
          <div class="social-login">
            <button type="button" class="btn btn-google w-100 mb-2">
              <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Google logo SVG -->
              </svg>
              <span>Continue with Google</span>
            </button>
            <div *ngIf="errorMessage" class="alert alert-danger mt-3 mb-0">
              <i class="bi bi-exclamation-circle me-2"></i>
              {{ errorMessage }}
            </div>
          </div>
        </form>
  
        <!-- Footer Links -->
        <div class="register-footer mt-4 text-center">
          <p class="mb-0">Already have an account? <a routerLink="/login" class="login-link">Log in</a></p>
          <p class="terms-text mt-2">By registering, you agree to our <a href="#" class="terms-link">Terms of Service</a> and <a href="#" class="terms-link">Privacy Policy</a></p>
        </div>
      </div>
    </div>
  </div>